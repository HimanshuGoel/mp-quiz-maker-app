<h1>Quiz Maker</h1>

<form class="quiz-maker-form">
  <table class="quiz-maker-full-width">
    <tr>
      <td>
        <mat-form-field class="quiz-maker-full-width" appearance="outline">
          <mat-label>Select a category</mat-label>
          <mat-select
            required
            id="categorySelect"
            [formControl]="categoryControl"
          >
            <mat-option
              *ngFor="let category of categories$ | async"
              [value]="category.id"
            >
              {{ category.name }}
            </mat-option>
          </mat-select>
          <mat-error *ngIf="categoryControl.hasError('required')">
            Category is <strong>required</strong>
          </mat-error>
        </mat-form-field>
      </td>
      <td>
        <mat-form-field class="quiz-maker-full-width" appearance="outline">
          <mat-label>Select difficulty</mat-label>
          <mat-select
            required
            id="difficultySelect"
            [formControl]="difficultyControl"
          >
            <mat-option
              *ngFor="let difficulty of difficulties"
              [value]="difficulty.id"
            >
              {{ difficulty.name }}
            </mat-option>
          </mat-select>
          <mat-error *ngIf="difficultyControl.hasError('required')">
            Difficulty is <strong>required</strong>
          </mat-error>
        </mat-form-field>
      </td>
      <td>
        <button
          id="createBtn"
          mat-stroked-button
          color="primary"
          (click)="createQuiz()"
          [disabled]="categoryControl.invalid || difficultyControl.invalid"
        >
          Create
        </button>
      </td>
    </tr>
  </table>

  <ng-container *ngIf="quizData$ | async as quizData">
    <section *ngFor="let quiz of quizData">
      <p [innerHTML]="quiz.question"></p>
      <section>
        <div class="example-button-row">
          <button
            *ngFor="let option of quiz.options"
            mat-flat-button
            [color]="option.isSelected ? 'primary' : null"
            (click)="onSelect(quiz, option)"
            [innerHtml]="option.text"
          ></button>
        </div>
      </section>
    </section>

    <button
      mat-raised-button
      color="primary"
      (click)="submitQuiz(quizData)"
      *ngIf="isVisible(quizData)"
    >
      Submit
    </button>
  </ng-container>
</form>
